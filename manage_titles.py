#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
–£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–º titles.txt
"""

import os
import sys

def load_titles(filename="titles.txt"):
    """–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ–º—ã –∏–∑ —Ñ–∞–π–ª–∞"""
    try:
        with open(filename, 'r', encoding='utf-8') as f:
            return [line.strip() for line in f if line.strip()]
    except FileNotFoundError:
        print(f"‚ùå –§–∞–π–ª {filename} –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        return []

def save_titles(titles, filename="titles.txt"):
    """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–º—ã –≤ —Ñ–∞–π–ª"""
    try:
        with open(filename, 'w', encoding='utf-8') as f:
            for title in titles:
                f.write(title + '\n')
        return True
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: {e}")
        return False

def show_titles(titles):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–µ–º—ã"""
    if not titles:
        print("üìù –°–ø–∏—Å–æ–∫ —Ç–µ–º –ø—É—Å—Ç")
        return
    
    print(f"üìù –í—Å–µ–≥–æ —Ç–µ–º: {len(titles)}")
    print("=" * 60)
    for i, title in enumerate(titles, 1):
        print(f"{i:2d}. {title}")
    print("=" * 60)

def add_title(titles):
    """–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—É—é —Ç–µ–º—É"""
    print("\n‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ç–µ–º—É")
    new_title = input("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Ç–µ–º—ã: ").strip()
    
    if not new_title:
        print("‚ùå –¢–µ–º–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π")
        return titles
    
    if new_title in titles:
        print("‚ö†Ô∏è –¢–∞–∫–∞—è —Ç–µ–º–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
        return titles
    
    titles.append(new_title)
    print(f"‚úÖ –¢–µ–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞: '{new_title}'")
    return titles

def remove_title(titles):
    """–£–¥–∞–ª—è–µ—Ç —Ç–µ–º—É"""
    if not titles:
        print("‚ùå –°–ø–∏—Å–æ–∫ —Ç–µ–º –ø—É—Å—Ç")
        return titles
    
    show_titles(titles)
    print("\nüóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ç–µ–º—É")
    try:
        index = int(input("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–º—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: ")) - 1
        if 0 <= index < len(titles):
            removed_title = titles.pop(index)
            print(f"‚úÖ –¢–µ–º–∞ —É–¥–∞–ª–µ–Ω–∞: '{removed_title}'")
        else:
            print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–º—ã")
    except ValueError:
        print("‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä")
    
    return titles

def search_titles(titles):
    """–ü–æ–∏—Å–∫ —Ç–µ–º –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É"""
    if not titles:
        print("‚ùå –°–ø–∏—Å–æ–∫ —Ç–µ–º –ø—É—Å—Ç")
        return
    
    keyword = input("\nüîç –í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –ø–æ–∏—Å–∫–∞: ").strip().lower()
    if not keyword:
        return
    
    found_titles = []
    for i, title in enumerate(titles, 1):
        if keyword in title.lower():
            found_titles.append((i, title))
    
    if found_titles:
        print(f"\nüéØ –ù–∞–π–¥–µ–Ω–æ {len(found_titles)} —Ç–µ–º:")
        print("=" * 60)
        for original_index, title in found_titles:
            print(f"{original_index:2d}. {title}")
        print("=" * 60)
    else:
        print(f"‚ùå –¢–µ–º—ã —Å –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–æ–º '{keyword}' –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")

def reset_titles():
    """–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª —Ç–µ–º"""
    original_titles = [
        "–ß—Ç–æ —Ç–∞–∫–æ–µ –ú–§–û –∏ —á–µ–º –æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –±–∞–Ω–∫–æ–≤?",
        "–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –Ω–∞–¥–µ–∂–Ω—É—é –ú–§–û –∏ –Ω–µ –ø–æ–ø–∞—Å—Ç—å –Ω–∞ –º–æ—à–µ–Ω–Ω–∏–∫–æ–≤?",
        "–ß—Ç–æ —Ç–∞–∫–æ–µ —Å–∫–æ—Ä–∏–Ω–≥–æ–≤—ã–π –±–∞–ª–ª –∏ –∫–∞–∫ –æ–Ω –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ –∑–∞–π–º–∞?",
        "–ú–æ–∂–Ω–æ –ª–∏ –ø–æ–ª—É—á–∏—Ç—å –º–∏–∫—Ä–æ–∑–∞–π–º —Å –ø–ª–æ—Ö–æ–π –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π?",
        "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ–∑–∞–π–º–æ–≤?",
        "–ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø–µ—Ä–µ–ø–ª–∞—Ç—É –ø–æ –º–∏–∫—Ä–æ–∑–∞–π–º—É ‚Äî –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ",
        "–ú–æ–∂–Ω–æ –ª–∏ –Ω–µ –ø–ª–∞—Ç–∏—Ç—å –º–∏–∫—Ä–æ–∑–∞–π–º? –û—Ç–≤–µ—Ç —é—Ä–∏—Å—Ç–∞",
        "5 –æ—à–∏–±–æ–∫ –∑–∞–µ–º—â–∏–∫–∞, –∏–∑-–∑–∞ –∫–æ—Ç–æ—Ä—ã—Ö –ú–§–û –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –∑–∞–π–º–µ",
        "–ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å —à–∞–Ω—Å—ã –Ω–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ –º–∏–∫—Ä–æ–∑–∞–π–º–∞: —Å–æ–≤–µ—Ç—ã –∏–∑–Ω—É—Ç—Ä–∏",
        "–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–∏—Ç—å –º–∏–∫—Ä–æ–∑–∞–π–º: —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è",
        "–¢–æ–ø-10 –ú–§–û —Å —Å–∞–º–æ–π –±—ã—Å—Ç—Ä–æ–π –≤—ã–¥–∞—á–µ–π –¥–µ–Ω–µ–≥ –Ω–∞ –∫–∞—Ä—Ç—É",
        "–†–µ–π—Ç–∏–Ω–≥ –ú–§–û —Å —Å–∞–º–æ–π –Ω–∏–∑–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —Å—Ç–∞–≤–∫–æ–π ‚Äî –∏—é–Ω—å 2025",
        "–ì–¥–µ –¥–∞—é—Ç –∑–∞–π–º –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫",
        "–õ—É—á—à–∏–µ –ú–§–û –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–π–º–∞ –ø–æ–¥ 0%",
        "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π –≤ Zaymer, Webbankir –∏ LimeZaim ‚Äî —á—Ç–æ –ª—É—á—à–µ?",
        "–ú–§–û —Å –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ–π –≤—ã–¥–∞—á–µ–π ‚Äî –∫—Ç–æ —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7?",
        "–ì–¥–µ –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ –ø–æ–ª—É—á–∏—Ç—å –º–∏–∫—Ä–æ–∑–∞–π–º –≤ 2025 –≥–æ–¥—É?",
        "7 –ú–§–û, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª—å–Ω–æ –≤—ã–¥–∞—é—Ç –±–µ–∑ –∑–≤–æ–Ω–∫–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫",
        "–ú–§–û —Å –ø—Ä–æ–¥–ª–µ–Ω–∏–µ–º –∑–∞–π–º–∞ ‚Äî –∫—Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ª—É—á—à–∏–µ —É—Å–ª–æ–≤–∏—è?",
        "–ì–¥–µ –ø–æ–ª—É—á–∏—Ç—å –∑–∞–π–º –Ω–∞ –ö–∏–≤–∏/–ÆMoney/–°–ë–ü ‚Äî –æ–±–∑–æ—Ä –ú–§–û –ø–æ —Å–ø–æ—Å–æ–±–∞–º –≤—ã–≤–æ–¥–∞",
        "–ö–∞–∫ —è –≤–∑—è–ª –º–∏–∫—Ä–æ–∑–∞–π–º –±–µ–∑—Ä–∞–±–æ—Ç–Ω—ã–º ‚Äî –ª–∏—á–Ω—ã–π –æ–ø—ã—Ç",
        "–†–µ–∞–ª—å–Ω—ã–π –æ—Ç–∑—ã–≤: –≤–∑—è–ª 5 –º–∏–∫—Ä–æ–∑–∞–π–º–æ–≤ –∏ –≤—ã–ø–ª–∞—Ç–∏–ª ‚Äî –≤–æ—Ç —á—Ç–æ –±—ã–ª–æ –¥–∞–ª—å—à–µ",
        "–ö–∞–∫ –º–Ω–µ –æ—Ç–∫–∞–∑–∞–ª–∏ 10 –ú–§–û –ø–æ–¥—Ä—è–¥ –∏ –∫—Ç–æ –≤ –∏—Ç–æ–≥–µ –≤—ã–¥–∞–ª –¥–µ–Ω—å–≥–∏",
        "–ò—Å—Ç–æ—Ä–∏—è: –∫–∞–∫ –º–∏–∫—Ä–æ–∑–∞–π–º –ø–æ–º–æ–≥ –∑–∞–∫—Ä—ã—Ç—å –∫—Ä–µ–¥–∏—Ç–∫—É –∏ –≤—ã–±—Ä–∞—Ç—å—Å—è –∏–∑ –¥–æ–ª–≥–æ–≤",
        "–†–µ–∞–ª—å–Ω—ã–π –∫–µ–π—Å: –∫–∞–∫ –≤–∑—è—Ç—å –∑–∞–π–º –ø–æ–¥ 0% –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–µ—Ä–µ–ø–ª–∞—Ç–∏—Ç—å",
        "3 –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑ –∂–∏–∑–Ω–∏: –∫–∞–∫ –º–∏–∫—Ä–æ–∑–∞–π–º—ã –ø–æ—Ä—Ç—è—Ç (–∏–ª–∏ —Å–ø–∞—Å–∞—é—Ç) –ª—é–¥–µ–π",
        "–ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ–º –º–∏–∫—Ä–æ–∑–∞–π–º–∞ ‚Äî —á—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—á–µ—Å—Ç—å",
        "–ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å –¥–µ–Ω—å–≥–∏, –µ—Å–ª–∏ –∑–∞–ø–ª–∞—Ç–∏–ª –º–æ—à–µ–Ω–Ω–∏–∫–∞–º –≤–º–µ—Å—Ç–æ –ú–§–û",
        "–ó–∞–∫–æ–Ω–Ω–æ –ª–∏ –Ω–∞—á–∏—Å–ª—è—é—Ç —à—Ç—Ä–∞—Ñ—ã –ø–æ –º–∏–∫—Ä–æ–∑–∞–π–º–∞–º? –û–±—ä—è—Å–Ω—è–µ–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ",
        "–ú–æ–∂–Ω–æ –ª–∏ —Å–ø–∏—Å–∞—Ç—å –º–∏–∫—Ä–æ–∑–∞–π–º —á–µ—Ä–µ–∑ –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ ‚Äî —Ä–∞–∑–±–æ—Ä –ø—Ä–æ—Ü–µ–¥—É—Ä—ã",
        "–ö–∞–∫ —Å–µ–±—è –≤–µ—Å—Ç–∏ —Å –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞–º–∏, –µ—Å–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–∏–ª –º–∏–∫—Ä–æ–∑–∞–π–º?",
        "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –ú–§–û —É–≥—Ä–æ–∂–∞–µ—Ç ‚Äî –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è",
        "–ö–∞–∫ –ø–æ–¥–∞—Ç—å –∂–∞–ª–æ–±—É –Ω–∞ –ú–§–û ‚Äî —à–∞–±–ª–æ–Ω—ã –∏ —Å–æ–≤–µ—Ç—ã",
        "–ú–∏–∫—Ä–æ–∑–∞–π–º –±–µ–∑ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ ‚Äî –≥–¥–µ –≤–∑—è—Ç—å –≤ –∏—é–Ω–µ 2025?",
        "–ú–∏–∫—Ä–æ–∑–∞–π–º –∑–∞ 5 –º–∏–Ω—É—Ç –±–µ–∑ –æ—Ç–∫–∞–∑–∞ ‚Äî —Å–ø–∏—Å–æ–∫ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –ú–§–û",
        "–ú–∏–∫—Ä–æ–∑–∞–π–º –±–µ–∑ –ø–∞—Å–ø–æ—Ä—Ç–∞ ‚Äî –º–∏—Ñ –∏–ª–∏ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å?",
        "–°—Ä–æ—á–Ω—ã–µ –¥–µ–Ω—å–≥–∏ –æ–Ω–ª–∞–π–Ω ‚Äî –∫–∞–∫–∏–µ –ú–§–û –≤—ã–¥–∞—é—Ç –∑–∞ 10 –º–∏–Ω—É—Ç?",
        "–ì–¥–µ –≤–∑—è—Ç—å –º–∏–∫—Ä–æ–∑–∞–π–º –±–µ–∑ —Ç—Ä—É–¥–æ—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞?",
        "–ú–∏–∫—Ä–æ–∑–∞–π–º —Å—Ç—É–¥–µ–Ω—Ç—É ‚Äî —Ä–µ–∞–ª—å–Ω–æ –ª–∏ –ø–æ–ª—É—á–∏—Ç—å –±–µ–∑ —Å–ø—Ä–∞–≤–æ–∫?",
        "–ö–∞–∫ –≤–∑—è—Ç—å –º–∏–∫—Ä–æ–∑–∞–π–º –ø–µ–Ω—Å–∏–æ–Ω–µ—Ä—É: —É—Å–ª–æ–≤–∏—è –∏ —Ä–∏—Å–∫–∏",
        "–ú–§–û, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–¥–∞—é—Ç –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –º–µ—Å—Ç—É –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞",
        "–ó–∞–π–º, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª–Ω–∏–ª–æ—Å—å 21 –≥–æ–¥–∞ ‚Äî –≥–¥–µ –≤—ã–¥–∞—é—Ç –º–æ–ª–æ–¥—ã–º?",
        "–ú–∏–∫—Ä–æ–∑–∞–π–º –±–µ–∑ –∑–≤–æ–Ω–∫–æ–≤ –Ω–∞ —Ä–∞–±–æ—Ç—É ‚Äî –∫–æ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?",
        "–ú–æ–∂–Ω–æ –ª–∏ –ø–æ–ª—É—á–∏—Ç—å –∑–∞–π–º —Å –ø—Ä–æ—Å—Ä–æ—á–∫–∞–º–∏ –≤ –¥—Ä—É–≥–∏—Ö –ú–§–û?",
        "–ö–∞–∫–∏–µ –ú–§–û —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Å–∞–º–æ–∑–∞–Ω—è—Ç—ã–º–∏ –∏ –ò–ü?",
        "–ì–¥–µ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∑–∞–π–º –ø–æ–¥ –º–∞—Ç–∫–∞–ø–∏—Ç–∞–ª/–ø–æ—Å–æ–±–∏–µ/—Å–æ—Ü–≤—ã–ø–ª–∞—Ç—ã?",
        "–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–≥–∞—à–∞—Ç—å –º–∏–∫—Ä–æ–∑–∞–π–º—ã, —á—Ç–æ–±—ã –Ω–µ –ø–æ–ø–∞—Å—Ç—å –≤ –¥–æ–ª–≥–æ–≤—É—é —è–º—É",
        "5 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∑–∞–π–º–∞–º–∏ –∏ —Ç—Ä–∞—Ç–∞–º–∏",
        "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∑–∞–π–º–∞: –ø–æ—Å—á–∏—Ç–∞–π, —Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–ø–ª–∞—Ç–∏—à—å (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä)",
        "–í–∏–∫—Ç–æ—Ä–∏–Ω–∞: —Ä–∞–∑–±–∏—Ä–∞–µ—à—å—Å—è –ª–∏ —Ç—ã –≤ –º–∏–∫—Ä–æ—Ñ–∏–Ω–∞–Ω—Å–∞—Ö? –ü—Ä–æ–π–¥–∏ —Ç–µ—Å—Ç"
    ]
    
    confirm = input(f"‚ö†Ô∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ {len(original_titles)} —Ç–µ–º? (y/n): ")
    if confirm.lower() in ['y', 'yes', '–¥–∞', '–¥']:
        if save_titles(original_titles):
            print(f"‚úÖ –°–ø–∏—Å–æ–∫ —Ç–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ({len(original_titles)} —Ç–µ–º)")
            return original_titles
        else:
            print("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏")
    
    return load_titles()

def show_menu():
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"""
    print("\n" + "=" * 60)
    print("üìã –£–ü–†–ê–í–õ–ï–ù–ò–ï –¢–ï–ú–ê–ú–ò –ü–û–°–¢–û–í")
    print("=" * 60)
    print("1. üìù –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–µ–º—ã")
    print("2. ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–º—É")
    print("3. üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ç–µ–º—É")
    print("4. üîç –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–º–∞–º")
    print("5. üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫")
    print("6. üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞")
    print("0. üö™ –í—ã—Ö–æ–¥")
    print("=" * 60)

def show_stats(titles):
    """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ç–µ–º"""
    if not titles:
        print("üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ - —Å–ø–∏—Å–æ–∫ —Ç–µ–º –ø—É—Å—Ç")
        return
    
    # –ü–æ–¥—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    total = len(titles)
    avg_length = sum(len(title) for title in titles) / total
    longest = max(titles, key=len)
    shortest = min(titles, key=len)
    
    # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
    categories = {
        '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ': ['–ß—Ç–æ —Ç–∞–∫–æ–µ', '–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç', '–ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è'],
        '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏': ['–ö–∞–∫', '–ü–æ—à–∞–≥–æ–≤–∞—è', '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è'],
        '–†–µ–π—Ç–∏–Ω–≥–∏/–°—Ä–∞–≤–Ω–µ–Ω–∏—è': ['–¢–æ–ø', '–†–µ–π—Ç–∏–Ω–≥', '–õ—É—á—à–∏–µ', '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ'],
        '–õ–∏—á–Ω—ã–π –æ–ø—ã—Ç': ['–†–µ–∞–ª—å–Ω—ã–π', '–õ–∏—á–Ω—ã–π –æ–ø—ã—Ç', '–ò—Å—Ç–æ—Ä–∏—è', '–ö–∞–∫ —è'],
        '–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ': ['–ó–∞–∫–æ–Ω–Ω–æ', '–Æ—Ä–∏—Å—Ç', '–ñ–∞–ª–æ–±–∞', '–ü—Ä–∞–≤–∞'],
        '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è': ['–±–µ–∑', '–ø–æ–¥ 0%', '–±—ã—Å—Ç—Ä–æ', '—Å—Ä–æ—á–Ω–æ']
    }
    
    category_counts = {}
    for category, keywords in categories.items():
        count = sum(1 for title in titles if any(keyword.lower() in title.lower() for keyword in keywords))
        if count > 0:
            category_counts[category] = count
    
    print(f"\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –¢–ï–ú:")
    print("=" * 60)
    print(f"–í—Å–µ–≥–æ —Ç–µ–º: {total}")
    print(f"–°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞: {avg_length:.1f} —Å–∏–º–≤–æ–ª–æ–≤")
    print(f"–°–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è: {len(longest)} —Å–∏–º–≤–æ–ª–æ–≤")
    print(f"  ‚îî‚îÄ {longest}")
    print(f"–°–∞–º–∞—è –∫–æ—Ä–æ—Ç–∫–∞—è: {len(shortest)} —Å–∏–º–≤–æ–ª–æ–≤")
    print(f"  ‚îî‚îÄ {shortest}")
    
    if category_counts:
        print(f"\n–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:")
        for category, count in sorted(category_counts.items(), key=lambda x: x[1], reverse=True):
            percentage = (count / total) * 100
            print(f"  {category}: {count} ({percentage:.1f}%)")
    
    print("=" * 60)

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    titles = load_titles()
    
    while True:
        show_menu()
        try:
            choice = input("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ").strip()
            
            if choice == '0':
                print("üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
                break
            elif choice == '1':
                show_titles(titles)
            elif choice == '2':
                titles = add_title(titles)
                if save_titles(titles):
                    print("üíæ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
            elif choice == '3':
                titles = remove_title(titles)
                if save_titles(titles):
                    print("üíæ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
            elif choice == '4':
                search_titles(titles)
            elif choice == '5':
                titles = reset_titles()
            elif choice == '6':
                show_stats(titles)
            else:
                print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")
                
        except KeyboardInterrupt:
            print("\n\nüëã –í—ã—Ö–æ–¥ –ø–æ Ctrl+C")
            break
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞: {e}")

if __name__ == "__main__":
    main() 